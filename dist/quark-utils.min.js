!function(n,e){"function"==typeof define&&define.amd?define(["quark","knockout","jquery","accounting-js","blockui"],e):(n.komapping=ko.mapping,e(n.$$,n.ko,n.$,n.accounting))}(this,function(n,e,o,i){function r(e,i){i?n.block(i,o(e)):n.unblock(o(e))}function t(n){var e={message:"Error",overlayCSS:{backgroundColor:"#A94442",opacity:.5},css:{border:"none",padding:"5px",backgroundColor:"#000","-webkit-border-radius":"5px","-moz-border-radius":"5px",backgroundColor:"#A94442",opacity:1,color:"#fff"},baseZ:900};return n&&(e.message="Hay problemas con este elemento.",e.overlayCSS={backgroundColor:"#FCF8E3",opacity:.4},e.css.backgroundColor="#FCF8E3",e.css.color="#000"),e}function a(n,e,i){e.length?o(n).block(t(i)):o(n).unblock()}function u(i,r,t,a){var u,d=r(),c={};n.isObject(d)?(u=d.value,c=d.config):u=d,e.isObservable(u)||(u=e.observable(u)),c=t?o.extend({},n.configuration.moneyFormat):o.extend({},n.configuration.numberFormat);var s=e.pureComputed({read:function(){return n.isDefined(u())?t?n.formatMoney(u(),c):n.formatNumber(u(),c):void 0},write:function(e){var o,i=u();o=t?n.unformatMoney(e,c.decimals):n.unformatNumber(e,c.decimals),isNaN(o)&&(o=e),o!==i?u(o):e!==i.toString()&&u.valueHasMutated()}}),l={};l[a]=s,e.applyBindingsToNode(i,l)}return e.bindingHandlers.stopBinding={init:function(n,e,o,i,r){return{controlsDescendantBindings:!0}}},e.bindingHandlers.upContext={init:function(n,o,i,r,t){var a=t.$parentContext.extend({$child:r,$childContext:t});return e.bindingHandlers.template.init(n,o,i,t.$parent,a)},update:function(n,o,i,r,t){var a=t.$parentContext.extend({$child:r,$childContext:t});return e.bindingHandlers.template.update(n,o,i,t.$parent,a)}},e.virtualElements.allowedBindings.upContext=!0,n.block=function(n,e){n||(n="Loading...");var i={message:n,css:{border:"none",padding:"5px",backgroundColor:"#000","-webkit-border-radius":"5px","-moz-border-radius":"5px",opacity:.7,color:"#fff"},baseZ:5e3};e?o(e).block(i):o.blockUI(i)},n.unblock=function(n){n?o(n).unblock():o.unblockUI()},e.bindingHandlers.block={init:function(n,o,i,t,a){var u=e.unwrap(o());r(n,u)},update:function(n,o,i,t,a){var u=e.unwrap(o());r(n,u)}},e.bindingHandlers.blockOnError={init:function(o,i,r,t,u){function d(e){n.isArray(e)&&a(o,e,!0)}var c=t.errorHandler,s=c.getByLevel(2e3,9999),l=s.subscribe(d);d(s()),e.utils.domNodeDisposal.addDisposeCallback(o,function(){l.dispose()})}},e.bindingHandlers.blockOnWarning={init:function(o,i,r,t,u){function d(e){if(n.isArray(e))for(var i in e){var r=e[i];if(r.level>2e3)return void a(o,e);if(r.level>=1e3&&r.level<2e3)return void a(o,e,!0)}}var c=t.errorHandler,s=c.getByLevel(1e3,9999),l=s.subscribe(d);d(s()),e.utils.domNodeDisposal.addDisposeCallback(o,function(){l.dispose()})}},e.bindingHandlers.blockOnErrorSource={init:function(o,i,r,t,u){function d(e){n.isArray(e)&&a(o,e)}var c=e.unwrap(i()),s=t.errorHandler,l=s.getBySource(c),f=l.subscribe(d);d(l()),e.utils.domNodeDisposal.addDisposeCallback(o,function(){f.dispose()})}},e.bindingHandlers.blockOnErrorCondition={init:function(o,i,r,t,u){function d(e){n.isArray(e)&&a(o,e)}var c=e.unwrap(i),s=t.errorHandler,l=s.getBy(c),f=l.subscribe(d);d(l()),e.utils.domNodeDisposal.addDisposeCallback(o,function(){f.dispose()})}},n.configuration||(n.configuration={}),n.configuration.moneyFormat={symbol:"$ ",decimals:2,separator:{thousands:".",decimal:","}},n.configuration.numberFormat={decimals:2,separator:{thousands:".",decimal:","}},n.formatMoney=function(e,r){return r=o.extend({},n.configuration.moneyFormat,r),i.formatMoney(e,r.symbol,r.decimals,r.separator.thousands,r.separator.decimal)},n.unformatMoney=function(e,r){r=o.extend({},n.configuration.moneyFormat,r);var t=i.unformat(e,r.separator.decimal);return i.toFixed(t,r.decimals)},n.formatNumber=function(e,r){return r=o.extend({},n.configuration.numberFormat,r),i.formatNumber(e,r.decimals,r.separator.thousands,r.separator.decimal)},n.unformatNumber=function(e,r){r=o.extend({},n.configuration.numberFormat,r);var t=i.unformat(e,r.separator.decimal);return i.toFixed(t,r.decimals)},e.bindingHandlers.numericValue={init:function(n,e){u(n,e,!1,"value")}},e.bindingHandlers.moneyValue={init:function(n,e){u(n,e,!0,"value")}},e.bindingHandlers.numericText={init:function(n,e){u(n,e,!1,"text")}},e.bindingHandlers.moneyText={init:function(n,e){u(n,e,!0,"text")}},e.bindingHandlers.rowSelect={update:function(o,i,r,t,a){var u=e.unwrap(i()),d=function(){return n.isFunction(u.isSelected)?{success:u.isSelected(t)}:{success:u.isSelected}};e.bindingHandlers.css.update(o,d,r,t,a);var c=function(){return u.select};e.bindingHandlers.click.init(o,c,r,t,a)}},"function"==typeof define&&define.amd&&define("knockout",function(){return e}),n});
